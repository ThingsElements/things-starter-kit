<link rel="import" href="../../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../../bower_components/things-ajax/things-ajax.html">
<link rel="import" href="../../things-content/things-resource-content.html">

<!--
용어 정의 화면 셋 

	Example:

		<things-base-terminology 
			data-route="[[screen.routing]]"
			title="[[screen.title]]"
			current-route="[[route]]"
			resource-type="[[screen.name]]"
			resource-url="[[screen.routing]]"
			detail-view="[[screen.detail_form_id]]"
			layout="fullbleed layout vertical"
			enable-detail-column>
		</things-base-terminology>
-->

<dom-module id="things-base-terminology">
	<template>
		<things-ajax 
			id="reload-cache"
			method="GET"
			resource-url="terminologies/resource_refresh">
		</things-ajax>

		<things-resource-content
			id="content"
			menu-id="18"
			title="[[title]]"
			layout="fullbleed layout vertical"
			grid-height="600"
			current-route="{{currentRoute}}"
			my-route="{{resourceUrl}}"
			resource-type="{{resourceType}}"
			resource-url="{{resourceUrl}}"
			grid-buttons="{{gridButtons}}"
			enable-detail-column>
		</things-resource-content>
	</template>

	<script>
		Polymer({
			is: 'things-base-terminology',

			properties: {
				/**
				 * 화면 타이틀 
				 */
				title: {
					type: String,
					value: function() {
						return Things.DataGlobal.t('menu.Terminology')
					}
				},

				/**
				 * 현재 메뉴에서 선택된 라우팅
				 */
				currentRoute: {
					type: String,
					notify : true
				},				

				/**
				 * 그리드 버튼
				 */
				gridButtons: {
					type: Array,
					value: function() {
						return [ {
							id: 'reload-btn',
							text: 'reload',
							icon: 'icons:reload'
						}, {
              id: 'export-btn',
              text: 'export',
              icon: 'icons:swap-vert'
						}, {
              id: 'import-btn',
              text: 'import',
              icon: 'icons:file-upload'
						}, {
              id: 'add-btn',
              text: 'add',
              icon: 'icons:add'
						}, {
              id: 'delete-btn',
              text: 'delete',
              icon: 'icons:delete'
						}, {
              id: 'save-btn',
              text: 'save',
              icon: 'icons:save'
						}, {
							id: 'print-btn',
							text: 'print',
							icon: 'icons:print'
						} ]
					}
				},

        /**
         * grid model
         */
        gridModel: {
          type: Array,
          value: [ { 
            fieldName: 'id' 
          }, { 
            fieldName: 'url' 
          }, { 
            fieldName: 'http_method' 
          }, { 
            fieldName: 'name' 
          }, { 
            fieldName: 'description'
          } ]
        },
        
        /**
         * grid columns
         */
        gridColumns: {
          type: Array,
          value: [ { 
            fieldName: 'id', name: 'id', width: 0 
          }, { 
            fieldName: 'name', name: 'name', width: 100,
            header: { text : 'Name' }
          }, { 
            fieldName: 'http_method', name: 'http_method', width: 80,
            header: { text : 'Method' }
          }, { 
            fieldName: 'url', name: 'url', width: 300,
            header : { text : 'URL' }
          }, { 
            fieldName: 'description', name: 'description', width: 375,
            header : { text : 'Description' }
          } ] 
        },				
			},

			listeners : {
				'reload-btn-tap': 'reloadCache',
				'print-btn-tap': 'printSheet'
			},

			/**
			 * Reload Cache
			 *
			 * @param {Object} e 버튼 탭 이벤트
			 */
			reloadCache: function(e) {
				this.$['reload-cache'].generateRequest();
			},

			/**
			 * Print Sheet
			 */
			printSheet: function(e) {
				var resourceGrid = this.$.content.getResourceGrid();
				var dsMain = resourceGrid.getGridDataSet();
				var grdMain = resourceGrid.getGridObject();
				DLReport.preview(grdMain, this.getPrintOption(), false);
			},

			getPrintOption: function() {
				var printOptions = 
						{
							print: {
								previewUrl: "preview.html"
							},
							reportHeaser: {
								items: [{
									text: "Terminology Document",
									styles: {
										fontSize: 30
									}
								}]
							},
							pageHeader: {
								items: [{
									text: 'HatioLab Inc.'
								}, {
									right: 0,
									text: 'Terminology Document'
								}]
							},
							grid: {
								display: {
									fitStyle: "even"
								},
								footer: {
									visible: true
								}
							},
							gridStyles: {
								grid: {
									border: null
								}
							}
						};
				return printOptions;
			}
		});
	</script>
</dom-module>