<link rel="import" href="../../../../bower_components/polymer/polymer.html">

<dom-module is="things-jay-test">
<template>
	<h4>things jay test</h4>
	<div id="grdMain" style="width: 900px; height: 300px"></div>
	<paper-button on-tap="printStart">print</paper-button>
</template>

<script>
	Polymer({
		is: 'things-jay-test',

		properties: {
			dsMain : {
				type: Object,
				value : function() {
					return this.getDsMain();
				}
			},

			grdMain: {
				type: Object,
				value: function() {
					return this.getDsMain();
				}
			}
		},

		attached: function() {
			this.grdMain = this.getGrdMain();
		},

		loadData: function(dsMain) {
			var dataSet = [{'product_id': '1',
										 'product_name': 'computer',
										 'customer_id': '1', 
										 'customer_name': 'Customer Name', 
										 'country': 'Korea', 
										 'phone': '010-1234-5678', 
										 'unit': '500', 
										 'currency': 'dollor', 
										 'unit_price': 1200, 
										 'quantity': 200, 
										 'order_date': '2015-05-18',
										 'ship_date': '2014-08-07'},
										 {'product_id': '1',
										 'product_name': 'computer',
										 'customer_id': '2', 
										 'customer_name': 'Customer Name', 
										 'country': 'Korea', 
										 'phone': '010-1234-5678', 
										 'unit': '500', 
										 'currency': 'dollor', 
										 'unit_price': 1200, 
										 'quantity': 200, 
										 'order_date': '2015-05-18',
										 'ship_date': '2014-08-07'}];

			dsMain.setRows(dataSet);
			return dsMain;
		},

		getPrintOption: function() {
	    var printOptions = {
	        print: {
	            previewUrl: "../../../previewer.html"
	        },
	        reportHeader: {
	            items: [{
	                text: "Order List",
	                styles: {
	                    paddingTop: 10,
	                    paddingBottom: 20,
	                    fontName: "Arial",
	                    fontSize: 30,
	                    fontUnderline: true
	                }
	            }]
	        },
	        reportFooter: {
	            items: [{
	                type: "list",
	                right: 0,
	                items: [{
	                    type: "summary",
	                    expression: "sum['quantity']",
	                    styles: {
	                        padding: 6,
	                        fontSize: 16,
	                        fontBold: true,
	                        numberFormat: "#,##0"
	                    },
	                    header: {
	                        text: "수량 합계: ",
	                        styles: {
	                            fontSize: 14
	                        }
	                    }
	                }],
	                styles: {
	                    background: "#100088ff",
	                    borderTop: "#aaa",
	                    borderBottom: "#aaa",
	                    marginTop: 10
	                }
	            }]
	        },
	        pageHeader: {
	            styles: {
	                margin: 4,
	                background: "#f8f8f8"
	            },
	            items: [{
	                left: 0,
	                text: 'Dataludi Inc.',
	                styles: {
	                    fontBold: true,
	                    fontItalic: true
	                }
	            }, {
	                right: 0,
	                data: '$report.date'
	            }]
	        },
	        grid: {
	            display: {
	                fitStyle: "even"
	            }
	        }
	    };

	    return printOptions;			
		},

		getDsMain: function() {
			var dsMain = DataLudi.createGridDataSet([
	        {
	            fieldName: "product_id",
	            dataType: "text",
	        }, {
	            fieldName: "product_name",
	            dataType: "text"
	        }, {
	            fieldName: "customer_id",
	            dataType: "text"
	          },{
	            fieldName: "customer_name",
	            dataType: "text"
	          },{
	            fieldName: "country",
	            dataType: "text"
	          },{
	            fieldName: "phone",
	            dataType: "text"
	          },{
	            fieldName: "unit",
	            dataType: "text"
	          },{
	            fieldName: "currency",
	            dataType: "text"
	          },
	        {
	            fieldName: "unit_price",
	            dataType: "number"
	        }, {
	            fieldName: "quantity",
	            dataType: "number"
	        }, {
	            fieldName: "order_date",
	            dataType: "text"
	        }, {
	            fieldName: "ship_date",
	            dataType: "text"
	        }
	    ]);

      return this.loadData(dsMain);
		},

		getGrdMain: function() {
			var grdMain = DataLudi.createGridView('grdMain', [
          {
              "name": "product_name",
              "fieldName": "product_name",
              "width": "90",
              "styles": {
              },
              "header": {
                  "text": "ProductName"
              }
          }, {
              "name": "customer_id",
              "fieldName": "customer_id",
              "width": "60",
              "styles": {
              },
              "header": {
                  "text": "Customer"
              }
          }, {
              "name": "customer_name",
              "fieldName": "customer_name",
              "width": "70",
              "styles": {
              },
              "header": {
                  "text": "CustomerName"
              }
          }, {
              "name": "phone",
              "fieldName": "phone",
              "width": "125",
              "styles": {
                  "textAlignment": "center"
              },
              "header": {
                  "text": "Phone"
              }
          }, {
              "name": "country",
              "fieldName": "country",
              "width": "70",
              "styles": {
              },
              "header": {
                  "text": "Country"
              },
              "footer": {
                  "text": "xxx",
                  "styles": {
                      "background": "#888888"
                  }
              }
          }, {
              "name": "quantity",
              "fieldName": "quantity",
              "width": 50,
              "styles": {
                  "textAlignment": "far"
              },
              "header": {
                  "text": "Quantity"
              },
              "footer": {
                  "expression": "sum",
                  "styles": {
                      "background": "#bbddff",
                      "color": "#00f",
                      "numberFormat": "#,##0",
                      "fontName": "Arial",
                      "fontBold": true,
                      "fontSize": 14
                  }
              }
          }, {
              "name": "order_date",
              "fieldName": "order_date",
              "width": "90",
              "styles": {
                  "datetimeFormat": "yyyy-MM-dd",
                  "textAlignment": "center"
              },
              "header": {
                  "text": "OrderDate"
              }
          }, {
              "name": "ship_date",
              "fieldName": "ship_date",
              "width": "90",
              "styles": {
                  "datetimeFormat": "yyyy-MM-dd",
                  "textAlignment": "center"
              },
              "header": {
                  "text": "ShipDate"
              },
              "footer": {
                  "text": "ShipDate",
                  "styles": {
                      "background": "#bbffdd"
                  }
              }
          }
      ], false);

			var dataSet = this.getDsMain();
      grdMain.setDataSource(dataSet);
      return grdMain;
		},

		printStart: function() {
			console.log('test');
      DLReport.preview(this.grdMain, this.getPrintOption(), true);
		}
	});
</script>



</dom-module>