<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="things-card-image">
	<template>
		<style>
			:host{
				display: block;
				background-color:var(--things-whitegrey-background-color);
			}
      paper-fab{
        @apply(--things-search-fab);
      }
			paper-card{
        @apply(--things-label-card-container)
      }
      paper-card:last-child{margin-right:0;}
      paper-card::shadow iron-image img{height:105px !important;}
      paper-card .card-info{
        padding:0 7px 7px 7px;
        font-size:11px;
        color:green;
      }
      paper-card::shadow .title-text{
        position:relative !important;
        border-top:1px dotted rgba(0,0,0,.09);
        padding:5px 7px 0 7px !important;
        font-size:14px !important
      }
			@media only all and (min-width: 400px)  {paper-card{width:  98% !important;}}
      @media only all and (min-width: 500px)  {paper-card{width:  47% !important;}}
      @media only all and (min-width: 800px)  {paper-card{width:  30% !important;}}
      @media only all and (min-width: 900px)  {paper-card{width:30.5% !important;}}
      @media only all and (min-width:1250px)  {paper-card{width:22.6% !important;}}
      @media only all and (min-width:1800px)  {paper-card{width:17.5% !important;}}
      @media only all and (min-width:2150px)  {paper-card{width:14.4% !important;}}
		</style>

		<paper-card id="card"
		  heading="[[heading]]"
	    image="[[image]]"
	    animated="[[animated]]"
	    animated-shadow="[[animatedShadow]]"
	    preload-image="[[preloadImage]]"
	    fade-image="[[fadeImage]]"
	    elevation="[[elevation]]">
	    <div class="card-info">
      	[[description]]
      </div>

    	<paper-icon-button id="toggle-btn" icon="arrow-drop-down" on-tap="_toggle"></paper-icon-button>
    	<iron-collapse id="card-detail">
					<template is="dom-repeat" items="[[detailForm]]">
						<span>[[item.name]] : [[item.value]]</span>
					</template>
      </iron-collapse>
		</paper-card>
	</template>

	<script>
		Polymer({
			is: 'things-card-image',

			properties: {
				
				menuInfo:  {
					type: Object
				},

				/**
				 * Ajax 호출 URL
				 */
				searchUrl: {
					type: String,
					value: '/labels'
				},

				heading: {
					type: String
				},

				image: {
					type: String
				},

				description: {
					type: String
				},

				/**
				 * Read-only property used to pass down the animatedShadow value to the underlying paper-material style (since they have different names).
				 */
				animated: {
					type: Boolean,
					value: false
				},

				/**
				 * Set this to true to animate the card shadow when setting a new z value.
				 */
				animatedShadow: {
					type: Boolean,
					value: false
				},

				/**
				 * When preloadImage is true, setting fadeImage to true will cause the image to fade into place.
				 */
				fadeImage: {
					type: Boolean,
					value: false
				},

				/**
				 * When true, any change to the image url property will cause the placeholder image to be shown until the image is fully rendered.
				 */
				preloadImage: {
					type: Boolean,
					value: false
				},

				/**
				 * The z-depth of the card, from 0-5.
				 */
				elevation: {
					type: Number
				},

				singleItem: {
					type: Object
				},

				fieldArray: {
					type: Array,
					observer: 'fieldArrayChanged'
				},

				detailObj: {
					type: Object
				},

				detailForm: {
					type: Object
				}
			},

			_toggle: function(e) {
				console.log(this.fieldArray);
				console.log(this.detailObj);
				this.$['card-detail'].toggle();
			},

			fieldArrayChanged: function(fieldArray) {
				var tempObj = this.detailObj;
				var newObjArr = [];

				for(var i = 0 ; i < fieldArray.length ; i++) {
					var prop = fieldArray[i];
					var value = this.detailObj[prop];
					newObjArr.push({ name : prop, value : value});
				}

				this.detailForm = newObjArr;
			}
		});
	</script>
</dom-module>